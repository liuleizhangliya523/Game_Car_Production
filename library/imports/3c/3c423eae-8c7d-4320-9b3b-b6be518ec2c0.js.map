{"version":3,"sources":["..\\..\\..\\..\\assets\\scrips/assets\\scrips\\car_btn.js"],"names":["cc","Class","extends","Component","properties","start","updateAmount","rootNode","find","_gameObj","getComponent","doPayOperation","rand_cost_rate","Tools","rand","rand_amount","key","node","name","GlobalGameData","amount_of_cars_others","node_bets","active","amount_of_cars","my","total","lb_my","lb_total","Label","string","toString","playArrowAnim","callBack","self","sp_last_result_flag","runAction","sequence","blink","delayTime","callFunc","btn_clickedCallBack","event","customEventData","target","console","log","ConstData","PAY_CASE_DATA","PAY_CASE","_totalOli","locked_oli_var","oli_var","playBtnSound","Tips","show","used_oli_var","updateOliLabel","oli","locked_oli","used_locked_oli_var"],"mappings":"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","file":"car_btn.js","sourceRoot":"..\\..\\..\\..\\assets\\scrips","sourcesContent":["import ConstData from \"./data/ConstData\";\r\nimport GlobalGameData from \"./data/GlobalGameData\";\r\nimport Tools from \"./tools/Tools\";\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n    properties: () => ({\r\n\r\n    }),\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    // onLoad () {},\r\n\r\n    start() {\r\n        // this.lb_my = cc.find(\"node_bets/label_my\", this.node);\r\n        // this.lb_total = cc.find(\"node_bets/label_total\", this.node);\r\n        // this.lb_my.getComponent(cc.Label).string = \"0\";\r\n        // this.lb_total.getComponent(cc.Label).string = \"0\";\r\n        this.updateAmount(\"0\", \"0\");\r\n        var rootNode = cc.find(\"Canvas\");\r\n        this._gameObj = rootNode.getComponent(\"game\");\r\n        // this.setAI_TimerEnable(true);\r\n    },\r\n    //开启模拟他人下注的定时器\r\n    // setAI_TimerEnable: function (isEnable) {\r\n\r\n    //     isEnable ?\r\n    //         this.schedule(this.doPayAI, 3) :\r\n    //         this.unschedule(this.doPayAI, this);\r\n    // },\r\n    //模拟他人下注\r\n    doPayOperation: function () {\r\n        // const randRate_isAdd = Tools.rand(0, 9);\r\n        // const randRate_case = Tools.rand(0, 2);\r\n        const rand_cost_rate = Tools.rand(1, 12);\r\n        const rand_amount = 100 * rand_cost_rate;\r\n        var key = this.node.name;//组件名其实就是数据对应的key\r\n\r\n        GlobalGameData.amount_of_cars_others[key] += rand_amount;\r\n        let node_bets = cc.find(\"node_bets\", this.node);\r\n        node_bets.active = true;\r\n        this.updateAmount(GlobalGameData.amount_of_cars[key], GlobalGameData.amount_of_cars_others[key]);\r\n\r\n    },\r\n    //更新投注金额UI\r\n    updateAmount: function (my, total) {\r\n        this.lb_my = cc.find(\"node_bets/label_my\", this.node);\r\n        this.lb_total = cc.find(\"node_bets/label_total\", this.node);\r\n        if (my != null) {\r\n            this.lb_total.getComponent(cc.Label).string = my.toString();\r\n\r\n        }\r\n        if (total != null) {\r\n            this.lb_my.getComponent(cc.Label).string = total.toString();\r\n        }\r\n    },\r\n    //播放投标动画\r\n    playArrowAnim: function (callBack) {\r\n        let self = this;\r\n        this.sp_last_result_flag = cc.find(\"last_result_flag\", this.node);\r\n        this.sp_last_result_flag.active = true;\r\n        // this.sp_last_result_flag.opacity = 0;\r\n        this.sp_last_result_flag.runAction(cc.sequence(cc.blink(1.5, 3), cc.delayTime(1), cc.callFunc(function () {\r\n            self.sp_last_result_flag.active = false;\r\n            if (callBack != null) {\r\n                callBack();\r\n            }\r\n        }, this)));\r\n    },\r\n    btn_clickedCallBack: function (event, customEventData) {\r\n        let node = event.target;\r\n        let node_bets = cc.find(\"node_bets\", node);\r\n        console.log(\"投注：\" + customEventData + \" 当前金额：\" + ConstData.PAY_CASE_DATA[ConstData.PAY_CASE]);\r\n\r\n        let _totalOli = GlobalGameData.locked_oli_var + GlobalGameData.oli_var;\r\n        this._gameObj.playBtnSound();\r\n        if (_totalOli < ConstData.PAY_CASE_DATA[ConstData.PAY_CASE]) {\r\n            Tips.show(\"您的余额不足\\n请充值后继续参与\", \"点击充值>>\", \"https://prodone.juxinbox.com/sinopecGameCt/weixinMng/ManageC/chargeOilIn.htm?back_url=https://game.juxinbox.com/trump_investment/login/authorize\");\r\n            //弹出剩余油滴不足\r\n        } else {\r\n            //先判断绑定油滴\r\n            if (GlobalGameData.oli_var > 0) {\r\n                if (GlobalGameData.oli_var >= ConstData.PAY_CASE_DATA[ConstData.PAY_CASE]) {\r\n                    if (GlobalGameData.used_oli_var + ConstData.PAY_CASE_DATA[ConstData.PAY_CASE] > 10000) {\r\n                        Tips.show(\"为了您的资金安全，单次投注最大上限不得超过10000。\", \"确定\", \"\");\r\n                        return;\r\n                    }\r\n                    GlobalGameData.oli_var -= ConstData.PAY_CASE_DATA[ConstData.PAY_CASE];\r\n                    GlobalGameData.used_oli_var += ConstData.PAY_CASE_DATA[ConstData.PAY_CASE];\r\n                    this._gameObj.updateOliLabel({\r\n                        oli: GlobalGameData.oli_var,\r\n                        locked_oli: GlobalGameData.locked_oli_var\r\n                    });\r\n                } else {\r\n                    if (GlobalGameData.used_oli_var + GlobalGameData.used_locked_oli_var + ConstData.PAY_CASE_DATA[ConstData.PAY_CASE] > 10000) {\r\n                        Tips.show(\"为了您的资金安全，单次投注最大上限不得超过10000。\", \"确定\", \"\");\r\n                        return;\r\n                    }\r\n                    GlobalGameData.used_oli_var += GlobalGameData.oli_var;\r\n                    GlobalGameData.oli_var -= ConstData.PAY_CASE_DATA[ConstData.PAY_CASE];\r\n\r\n                    GlobalGameData.locked_oli_var += GlobalGameData.oli_var;\r\n                    GlobalGameData.used_locked_oli_var -= GlobalGameData.oli_var;\r\n\r\n                    if (GlobalGameData.oli_var < 0) {\r\n                        GlobalGameData.oli_var = 0;\r\n                    }\r\n                    this._gameObj.updateOliLabel({\r\n                        oli: GlobalGameData.oli_var,\r\n                        locked_oli: GlobalGameData.locked_oli_var\r\n                    });\r\n                }\r\n            } else {\r\n                if (GlobalGameData.used_locked_oli_var + ConstData.PAY_CASE_DATA[ConstData.PAY_CASE] > 10000) {\r\n                    Tips.show(\"为了您的资金安全，单次投注最大上限不得超过10000。\", \"确定\", \"\");\r\n                    return;\r\n                }\r\n                GlobalGameData.locked_oli_var -= ConstData.PAY_CASE_DATA[ConstData.PAY_CASE];\r\n                GlobalGameData.used_locked_oli_var += ConstData.PAY_CASE_DATA[ConstData.PAY_CASE];\r\n                this._gameObj.updateOliLabel({\r\n                    oli: GlobalGameData.oli_var,\r\n                    locked_oli: GlobalGameData.locked_oli_var\r\n                });\r\n            }\r\n            node_bets.active = true;\r\n            GlobalGameData.amount_of_cars[customEventData] += ConstData.PAY_CASE_DATA[ConstData.PAY_CASE];\r\n            this.updateAmount(GlobalGameData.amount_of_cars[customEventData], GlobalGameData.amount_of_cars_others[customEventData]);\r\n            cc.log(\"已经消耗的U币： \" + GlobalGameData.used_locked_oli_var);\r\n            cc.log(\"已经消耗的油滴： \" + GlobalGameData.used_oli_var);\r\n        }\r\n    }\r\n    // update (dt) {},\r\n});"]}