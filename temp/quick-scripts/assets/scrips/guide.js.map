{"version":3,"sources":["guide.js"],"names":["cc","Class","extends","Component","properties","layout_step1","type","Layout","default","layout_step2","layout_step3","layout_step4","layout_start_game","music_btn","AudioSource","scroll_view_notice","ScrollView","node_notice","Node","rich_text_notice_content","RichText","onBridgeReady","console","log","WeixinJSBridge","call","onLoad","ConstData","DEBUG","useragent","navigator","userAgent","match","sys","platform","DESKTOP_BROWSER","alert","opened","window","open","opener","close","reviveShare","WECHAT_GAME","shareData","shareFriends","postData","location","href","Tools","sendHttpRequest","err","resp","wx","config","title","desc","link","imgUrl","trigger","res","success","cancel","fail","ready","onMenuShareAppMessage","onMenuShareTimeline","hideMenuItems","menuList","error","start","self","isBrowser","url","userKey","substring","lastIndexOf","length","openId","GlobalGameData","openID","URL","_isFirstPlay","localStorage","getItem","info","node","active","director","preloadScene","getNotice","nextBtnClicked","event","customEventData","play","setItem","startGameClicked","oli_var","Number","oilNum","locked_oli_var","uCoin","headImgUrl","loadScene","onNoticeOkClicked","game_notice_time_stamp","noticeTimeStamp","game_notice_text","content","date","string","ht","height","bind","webViewCallback","webview","eventType"],"mappings":"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","file":"guide.js","sourceRoot":"..\\..\\..\\..\\assets\\scrips","sourcesContent":["import GlobalGameData from \"./data/GlobalGameData\";\r\nimport ConstData from \"./data/ConstData\";\r\nimport Tools from \"./tools/Tools\";\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        layout_step1: {\r\n            type: cc.Layout,\r\n            default: null\r\n        },\r\n        layout_step2: {\r\n            type: cc.Layout,\r\n            default: null\r\n        },\r\n        layout_step3: {\r\n            type: cc.Layout,\r\n            default: null\r\n        },\r\n        layout_step4: {\r\n            type: cc.Layout,\r\n            default: null\r\n        },\r\n        layout_start_game: {\r\n            type: cc.Layout,\r\n            default: null\r\n        },\r\n        music_btn: {\r\n            type: cc.AudioSource,\r\n            default: null\r\n        },\r\n        scroll_view_notice: {\r\n            type: cc.ScrollView,\r\n            default: null\r\n        },\r\n        node_notice: {\r\n            type: cc.Node,\r\n            default: null\r\n        },\r\n        rich_text_notice_content: {\r\n            type: cc.RichText,\r\n            default: null\r\n        }\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n    onBridgeReady() {\r\n        console.log(\"guide.js隐藏tool bar\")\r\n        WeixinJSBridge.call('showToolbar');\r\n        WeixinJSBridge.call('showOptionMenu');\r\n    },\r\n    onLoad() {\r\n        if (ConstData.DEBUG) {\r\n            return;\r\n        }\r\n        var useragent = navigator.userAgent;\r\n        if (useragent.match(/MicroMessenger/i) != 'MicroMessenger' && cc.sys.platform == cc.sys.DESKTOP_BROWSER) {\r\n            // 这里警告框会阻塞当前页面继续加载  \r\n            alert('请使用微信打开链接');\r\n            // 以下代码是用javascript强行关闭当前页面  \r\n            var opened = window.open('about:blank', '_self');\r\n            opened.opener = null;\r\n            opened.close();\r\n        }\r\n    },\r\n    reviveShare() {\r\n        if (cc.sys.platform != cc.sys.WECHAT_GAME) {\r\n            var shareData = {};\r\n            var shareFriends = {};\r\n            var postData = \"currUrl=\" + window.location.href;\r\n            Tools.sendHttpRequest(\"POST\", \"login/toShare\", postData, function (err, resp) {\r\n                if (!err) {\r\n                    console.log(\"微信分享config\");\r\n                    wx.config(resp);//有礼付分享项目传回的信息\r\n                    shareData = {\r\n                        title: '来王牌投资，做金牌投资人！',\r\n                        desc: \"油滴快人一步，油费步步快~\",\r\n                        link: \"https://game.juxinbox.com/trump_investment/login/authorizeShareAppMessage\",//分享跳转链接，必须在JS安全域名下！\r\n                        imgUrl: \"https://game.juxinbox.com/share.png\",//分享图片地址\r\n                        // linkpath + '/share.jsp='+wxId+'&id='+currentId;\r\n                        trigger: function (res) {\r\n                        },\r\n                        success: function (res) {\r\n\r\n                        },\r\n                        cancel: function (res) {\r\n                        },\r\n                        fail: function (res) {\r\n                            console.log(res);\r\n                        }\r\n                    };\r\n                    shareFriends = {\r\n                        title: '来王牌投资，做金牌投资人！',\r\n                        desc: '油滴快人一步，油费步步快~',\r\n                        link: \"https://game.juxinbox.com/trump_investment/login/authorizeShareTimeline\",//分享跳转链接，必须在JS安全域名下！\r\n                        imgUrl: \"https://game.juxinbox.com/share.png\",//分享图片地址\r\n                        // linkpath + '/share.jsp='+wxId+'&id='+currentId;\r\n                        trigger: function (res) {\r\n                        },\r\n                        success: function (res) {\r\n\r\n                        },\r\n                        cancel: function (res) {\r\n                        },\r\n                        fail: function (res) {\r\n                        }\r\n                    };\r\n                    wx.ready(function () {\r\n                        console.log(\"wx.ready\");\r\n                        // if (typeof WeixinJSBridge == \"undefined\") {\r\n                        //     console.log(\"WeixinJSBridge undefined.\");\r\n                        //     if (document.addEventListener) {\r\n                        //         console.log(\"WeixinJSBridge document.addEventListener.\");\r\n                        //         document.addEventListener('WeixinJSBridgeReady', onBridgeReady, false);\r\n                        //     }\r\n                        //     else if (document.attachEvent) {\r\n                        //         console.log(\"WeixinJSBridge document.attachEvent.\");\r\n                        //         document.attachEvent('WeixinJSBridgeReady', onBridgeReady);\r\n                        //         document.attachEvent('onWeixinJSBridgeReady', onBridgeReady);\r\n                        //     }\r\n                        // }\r\n                        // else {\r\n                        //     this.onBridgeReady();\r\n                        // }\r\n                        wx.onMenuShareAppMessage(shareData);\r\n                        wx.onMenuShareTimeline(shareFriends);\r\n                        wx.hideMenuItems({\r\n                            menuList: [\r\n                                \"menuItem:openWithSafari\",\r\n                                \"menuItem:openWithQQBrowser\",\r\n                                \"menuItem:copyUrl\"\r\n                            ] // 要隐藏的菜单项，只能隐藏“传播类”和“保护类”按钮，所有menu项见附录3\r\n                        });\r\n                    });\r\n                    wx.error(function (res) {\r\n                        //alert(JSON.stringify(res));\r\n                    });\r\n                }\r\n                else {\r\n                    cc.log(\"http request error: \" + err);\r\n                }\r\n            });\r\n        }\r\n    },\r\n\r\n    start() {\r\n        var self = this;\r\n        if (cc.sys.isBrowser) {\r\n            var url = window.location.href;\r\n            // console.log(\"当前页URL：\" + url);\r\n            var userKey = url.substring(url.lastIndexOf(\"userKey=\") + \"userKey=\".length, url.length);\r\n\r\n            // var openID = \"o4FD4v8834LK4k7t2G5_RV42JnzI\";\r\n            // GlobalGameData.openID = openID;\r\n\r\n            var postData = \"userKey=\" + userKey;\r\n            Tools.sendHttpRequest(\"POST\", \"login/getOpenId\", postData, function (err, resp) {\r\n                if (!err) {\r\n                    console.log(\"openID:\" + resp.openId);\r\n                    GlobalGameData.openID = resp.openId;\r\n                    self.reviveShare();\r\n                }\r\n                else {\r\n                    window.location.href = ConstData.URL + \"login/authorize\";\r\n                    cc.log(\"http request error: \" + err);\r\n                    return;\r\n                }\r\n            });\r\n        }\r\n        // cc.sys.localStorage.removeItem(\"IsFirstPlay\");\r\n        var _isFirstPlay = cc.sys.localStorage.getItem(\"IsFirstPlay\");\r\n        if (_isFirstPlay === null || _isFirstPlay === \"true\") {\r\n            cc.info(\"IsFirstPlay = \" + _isFirstPlay + \" 弹出引导\");\r\n            this.layout_step1.node.active = true;\r\n        }\r\n        else {\r\n            // cc.sys.localStorage.setItem(\"IsFirstPlay\", \"false\");\r\n            cc.info(\"IsFirstPlay = \" + _isFirstPlay + \" 跳过引导\");\r\n            cc.director.preloadScene(\"game\", function () {\r\n                cc.log(\"Next scene preloaded\");\r\n            });\r\n            this.layout_start_game.node.active = true;\r\n            this.getNotice();\r\n        }\r\n    },\r\n    nextBtnClicked: function (event, customEventData) {\r\n        cc.log(\"点击下一步: \" + customEventData);\r\n        this.music_btn.play();\r\n        switch (customEventData) {\r\n            case \"1\":\r\n                this.layout_step1.node.active = false;\r\n                this.layout_step2.node.active = true;\r\n                break;\r\n            case \"2\":\r\n                this.layout_step2.node.active = false;\r\n                this.layout_step3.node.active = true;\r\n                cc.director.preloadScene(\"game\", function () {\r\n                    cc.log(\"Next scene preloaded\");\r\n                });\r\n                break;\r\n            case \"3\":\r\n                this.layout_step3.node.active = false;\r\n                this.layout_step4.node.active = true;\r\n                break;\r\n            case \"4\":\r\n                this.layout_step4.node.active = false;\r\n                this.layout_start_game.node.active = true;\r\n                this.getNotice();\r\n                cc.sys.localStorage.setItem(\"IsFirstPlay\", \"false\");\r\n                // cc.director.loadScene(\"game\");\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    },\r\n    startGameClicked: function () {\r\n        this.music_btn.play();\r\n        var postData = \"openId=\" + GlobalGameData.openID;\r\n        Tools.sendHttpRequest(\"POST\", \"login/searchUser\", postData, function (err, resp) {\r\n            if (!err) {\r\n                GlobalGameData.oli_var = Number(resp.oilNum);\r\n                GlobalGameData.locked_oli_var = Number(resp.uCoin);\r\n                GlobalGameData.headImgUrl = resp.headImgUrl;\r\n                console.log(GlobalGameData.headImgUrl);\r\n                cc.director.loadScene(\"game\");\r\n            }\r\n            else {\r\n                cc.log(\"http request error: \" + err);\r\n            }\r\n        });\r\n    },\r\n    onNoticeOkClicked() {\r\n        cc.log(\"公告时间戳： \" + GlobalGameData.game_notice_time_stamp);\r\n        cc.sys.localStorage.setItem(\"noticeTimeStamp\", GlobalGameData.game_notice_time_stamp);\r\n        this.node_notice.active = false;\r\n    },\r\n    getNotice() {\r\n        //获取公告\r\n        let noticeTimeStamp = cc.sys.localStorage.getItem(\"noticeTimeStamp\");\r\n        Tools.sendHttpRequest(\"POST\", \"game/getNotice\", \"\", function (err, resp) {\r\n            if (!err) {\r\n                GlobalGameData.game_notice_text = resp.content;\r\n\r\n                if (noticeTimeStamp != resp.date) {\r\n                    GlobalGameData.game_notice_time_stamp = resp.date;\r\n                    this.rich_text_notice_content.string = GlobalGameData.game_notice_text;\r\n                    let ht = this.rich_text_notice_content.node.height;\r\n                    this.scroll_view_notice.content.height = ht + 60;\r\n                    this.node_notice.active = true;\r\n                    cc.log(\"弹出公告\");\r\n                }\r\n                else {\r\n                    cc.log(\"公告已获取过，不弹出\")\r\n                }\r\n            }\r\n            else {\r\n                cc.log(\"获取公告失败-> http request error: \" + err);\r\n                return;\r\n            }\r\n        }.bind(this));\r\n    },\r\n    webViewCallback: function (webview, eventType, customEventData) {\r\n        cc.log(\"eventType:\" + eventType);\r\n    }\r\n    // update (dt) {},\r\n});\r\n"]}