{"version":3,"sources":["Tools.js"],"names":["Tools","rand","min","max","Math","floor","random","getRandArray","n","numbers","out","i","index","outIdx","tmp","sendHttpRequest","type","cmd","data","callBack","_httpHandler","cc","loader","getXMLHttpRequest","wholeURL","ConstData","URL","error","code","msg","status","onreadystatechange","console","log","readyState","response","_respObj","JSON","parse","Tips_2","show","resultObject","open","setRequestHeader","send"],"mappings":"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","file":"Tools.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\scrips\\tools","sourcesContent":["import ConstData from \"./../data/ConstData\";\r\n\r\nconst Tools = {};\r\n// _httpHandler.responseType = \"json\";\r\nTools.rand = function (min, max) {\r\n    return Math.floor(Math.random() * (max - min + 1) + min);\r\n};\r\nTools.getRandArray = function (min, max, n) {\r\n    let numbers = [];\r\n    let out = [];\r\n    let i = 0;\r\n    for (let index = min; index <= max; index++) {\r\n        numbers[i] = index;\r\n        i++;\r\n    }\r\n    for (let i = 0; i < n; i++) {\r\n        let outIdx = Tools.rand(0, max - i) + i;\r\n\r\n        let tmp = numbers[i];\r\n        numbers[i] = numbers[outIdx];\r\n        numbers[outIdx] = tmp;\r\n\r\n        out[i] = numbers[i];\r\n    }\r\n    return out;\r\n};\r\n\r\nTools.sendHttpRequest = function (type, cmd, data, callBack) {\r\n    {\r\n        var _httpHandler = cc.loader.getXMLHttpRequest();\r\n        var wholeURL = ConstData.URL + cmd;\r\n        // _httpHandler.timeout = 5000;\r\n        \r\n        if (_httpHandler != null) {\r\n            var error = {};\r\n            error.code = -1;\r\n            error.msg = \"\";\r\n            error.status = 0;\r\n            // ['loadstart', 'abort', 'error', 'load', 'loadend', 'timeout'].forEach(function (eventname) {\r\n            //     _httpHandler[\"on\" + eventname] = function (target, type) {\r\n            //         console.log(\"Event : \" + eventname);\r\n            //     };\r\n            // });\r\n            _httpHandler.onreadystatechange = function () {\r\n                console.log(\"readyState: \" + _httpHandler.readyState + \" status: \" + _httpHandler.status);\r\n                if (_httpHandler.readyState == 4 && (_httpHandler.status >= 200 && _httpHandler.status < 400)) {\r\n                    let response = _httpHandler.response;\r\n                    console.log(response);\r\n                    if (callBack != null) {\r\n                        var _respObj = JSON.parse(response);\r\n                        if (typeof _respObj == \"string\") {\r\n                            _respObj = JSON.parse(_respObj);\r\n                        }\r\n                        if (_respObj.code == 1) {\r\n                            if (_respObj.msg === \"停服\") {\r\n                                Tips_2.show(\"Notice\", \"Server disconnected\", 0);\r\n                            }\r\n                            else {\r\n                                var data = _respObj.data;\r\n                                if (!_respObj.data) {\r\n                                    data = _respObj.resultObject;\r\n                                }\r\n                                callBack(null, data);\r\n                            }\r\n                        } else {\r\n                            callBack(_respObj.msg, _respObj.data);\r\n                        }\r\n                    }\r\n                }\r\n            };\r\n            _httpHandler.open(type, wholeURL, true);\r\n            _httpHandler.setRequestHeader(\"Content-Type\", \"application/x-www-form-urlencoded\");\r\n            console.log(\"Send params  : \" + data);\r\n            _httpHandler.send(data);\r\n        }\r\n    }\r\n};\r\nexport default Tools;"]}